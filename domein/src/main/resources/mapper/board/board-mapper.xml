<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">


	<insert parameterType="boardKnowBattle" id="insertBoard">
		INSERT INTO BOARD_KNOW_BATTLE VALUES(SEQ_THREAD_KEY.NEXTVAL,
			#{threadTitle},
			#{writerKey},
			#{writtenDate},
			#{modifiedDate},
			#{readCount},
			#{threadStatusNo}
			)
	</insert>
	
	<insert parameterType="attachment" id="insertAttachment">
		INSERT INTO BKB_ATTACHED_IMAGE VALUES(
		#{fileKey},
		#{articleNo},
		#{originalFileName},
		#{renamedFileName},
		)
	</insert>
	<select id="selectBoardList" resultType="map">
<!-- 		select b.*, (select count(*) from ATTACHMENT WHERE B.ARTICLENO=ARTICLENO) AS ATTCOUNT
		from BOARD_KNOW_BATTLE B order by writtenDate desc -->
		SELECT * FROM BOARD_KNOW_BATTLE ORDER BY WRITTEN_DATE DESC
	</select>
	<select id="selectCount" resultType="_int">
		select count(*) from BOARD_KNOW_BATTLE	
	</select>


	<select id="selectBkbArticles" parameterType="_int" resultType="map">
		SELECT BA.*,BKB.THREAD_TITLE,M.NICKNAME FROM BKB_ARTICLE BA LEFT JOIN BOARD_KNOW_BATTLE BKB ON BA.THREAD_KEY = BKB.THREAD_KEY LEFT JOIN MEMBER M ON BA.WRITER_KEY = M.MEMBER_KEY WHERE BA.THREAD_KEY = #{threadKey}
	</select>
</mapper>
